"""
–ß–µ–ª–æ–≤–µ—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å—Ç–∞–Ω–∫–∞.
"""


class HumanRecommender:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ–Ω—è—Ç–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π."""

    @staticmethod
    def get_recommendation(context):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞."""

        if not context.material or not context.operation:
            return "–ù—É–∂–Ω–æ –∑–Ω–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –∏ –æ–ø–µ—Ä–∞—Ü–∏—é, —á—Ç–æ–±—ã –¥–∞—Ç—å —Å–æ–≤–µ—Ç."

        material = context.material.lower()
        operation = context.operation.lower()
        mode = context.mode.lower() if context.mode else ""

        # === –ê–õ–Æ–ú–ò–ù–ò–ô ===
        if '–∞–ª—é–º–∏–Ω' in material:
            if '—Ç–æ–∫–∞—Ä' in operation:
                if '—á–µ—Ä–Ω–æ–≤' in mode:
                    return HumanRecommender._aluminum_turning_rough(context)
                elif '—á–∏—Å—Ç–æ–≤' in mode:
                    return HumanRecommender._aluminum_turning_finish(context)
                else:
                    return HumanRecommender._aluminum_turning_general(context)

            elif '—Ñ—Ä–µ–∑' in operation:
                return HumanRecommender._aluminum_milling(context)

        # === –°–¢–ê–õ–¨ ===
        elif '—Å—Ç–∞–ª—å' in material:
            if '—Ç–æ–∫–∞—Ä' in operation:
                if '—á–µ—Ä–Ω–æ–≤' in mode:
                    return HumanRecommender._steel_turning_rough(context)
                elif '—á–∏—Å—Ç–æ–≤' in mode:
                    return HumanRecommender._steel_turning_finish(context)
                else:
                    return HumanRecommender._steel_turning_general(context)

            elif '—Ñ—Ä–µ–∑' in operation:
                return HumanRecommender._steel_milling(context)

        # === –û–ë–©–ò–ô –°–õ–£–ß–ê–ô ===
        return HumanRecommender._general_advice(material, operation, context)

    @staticmethod
    def _aluminum_turning_rough(context=None):
        base = (
            "üè≠ **–î–ª—è —á–µ—Ä–Ω–æ–≤–æ–π —Ç–æ–∫–∞—Ä–∫–∏ –∞–ª—é–º–∏–Ω–∏—è:**\n\n"
            "**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∞–Ω–∫–∞:**\n"
            "‚Ä¢ –û–±–æ—Ä–æ—Ç—ã: 1000-2000 –æ–±/–º–∏–Ω –¥–ª—è √ò50-100 –º–º\n"
            "‚Ä¢ –ü–æ–¥–∞—á–∞: 0.3-0.5 –º–º/–æ–± ‚Äî –∞–ª—é–º–∏–Ω–∏–π –º—è–≥–∫–∏–π\n"
            "‚Ä¢ –ì–ª—É–±–∏–Ω–∞: 3-5 –º–º –∑–∞ –ø—Ä–æ—Ö–æ–¥\n\n"
            "**–°–æ–≤–µ—Ç—ã:**\n"
            "‚Ä¢ –û—Å—Ç—Ä—ã–π —Ä–µ–∑–µ—Ü —Å –±–æ–ª—å—à–∏–º –ø–µ—Ä–µ–¥–Ω–∏–º —É–≥–ª–æ–º\n"
            "‚Ä¢ –°—Ç—Ä—É–∂–∫–∞ –¥–æ–ª–∂–Ω–∞ –ª–æ–º–∞—Ç—å—Å—è\n"
            "‚Ä¢ –í–æ–∑–¥—É—Ö –≤–º–µ—Å—Ç–æ –°–û–ñ\n"
            "‚Ä¢ –ù–µ –±–æ–π—Å—è –≤—ã—Å–æ–∫–∏—Ö –æ–±–æ—Ä–æ—Ç–æ–≤"
        )

        if context and hasattr(context, 'diameter') and context.diameter:
            try:
                dia = float(context.diameter.replace(',', '.'))
                if dia < 10:
                    advice = (
                        f"\n\nüí° **–î–ª—è √ò{dia} –º–º:**\n"
                        "‚Ä¢ –û–±–æ—Ä–æ—Ç—ã: 3000+ –æ–±/–º–∏–Ω (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å –≤–∏–±—Ä–∞—Ü–∏—è–º–∏!)\n"
                        "‚Ä¢ –ü–æ–¥–∞—á–∞: 0.1-0.2 –º–º/–æ–±\n"
                        "‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–ª–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞\n"
                        "‚Ä¢ –ò–¥–µ–∞–ª—å–Ω–æ –æ—Å—Ç—Ä—ã–π —Ä–µ–∑–µ—Ü"
                    )
                    return base + advice
                elif dia < 30:
                    advice = (
                        f"\n\nüí° **–î–ª—è √ò{dia} –º–º:**\n"
                        "‚Ä¢ –û–±–æ—Ä–æ—Ç—ã: 1500-2500 –æ–±/–º–∏–Ω\n"
                        "‚Ä¢ –ü–æ–¥–∞—á–∞: 0.2-0.4 –º–º/–æ–±\n"
                        "‚Ä¢ –°–ª–µ–¥–∏ –∑–∞ –≤–∏–±—Ä–∞—Ü–∏—è–º–∏\n"
                        "‚Ä¢ –ú–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–æ"
                    )
                    return base + advice
            except:
                pass

        return base

    # –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–∏—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ...

    @staticmethod
    def _aluminum_turning_finish():
        return (
            "‚ú® **–î–ª—è —á–∏—Å—Ç–æ–≤–æ–π —Ç–æ–∫–∞—Ä–∫–∏ –∞–ª—é–º–∏–Ω–∏—è:**\n\n"
            "**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –±–ª–µ—Å–∫–∞:**\n"
            "‚Ä¢ –û–±–æ—Ä–æ—Ç—ã: –º–∞–∫—Å–∏–º—É–º, 1500-3000 –æ–±/–º–∏–Ω\n"
            "‚Ä¢ –ü–æ–¥–∞—á–∞: –º–∞–ª–µ–Ω—å–∫–∞—è, 0.1-0.2 –º–º/–æ–±\n"
            "‚Ä¢ –ì–ª—É–±–∏–Ω–∞: 0.5-1 –º–º –Ω–∞ —Ñ–∏–Ω–∏—à\n\n"
            "**–ö–∞–∫ –¥–æ–±–∏—Ç—å—Å—è –∑–µ—Ä–∫–∞–ª–∞:**\n"
            "‚Ä¢ –†–µ–∑–µ—Ü –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –û–ß–ï–ù–¨ –æ—Å—Ç—Ä—ã–º\n"
            "‚Ä¢ –†–∞–¥–∏—É—Å –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ ‚Äî 0.4-0.8 –º–º\n"
            "‚Ä¢ –ü–æ–¥–∞–≤–∞–π –≤–æ–∑–¥—É—Ö –¥–ª—è –æ—Ç–≤–æ–¥–∞ —Å—Ç—Ä—É–∂–∫–∏\n"
            "‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Ö–æ–¥ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥–∞—á–∞"
        )

    @staticmethod
    def _aluminum_turning_general():
        return (
            "üîß **–ü–æ –∞–ª—é–º–∏–Ω–∏—é –¥–ª—è —Ç–æ–∫–∞—Ä–∫–∏:**\n\n"
            "**–û–±—â–∏–π –ø–æ–¥—Ö–æ–¥:**\n"
            "‚Ä¢ –ê–ª—é–º–∏–Ω–∏–π –ª—é–±–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –æ—Å—Ç—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç\n"
            "‚Ä¢ –ú–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Å—É—Ö—É—é –∏–ª–∏ —Å –≤–æ–∑–¥—É—Ö–æ–º\n"
            "‚Ä¢ –°—Ç—Ä—É–∂–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–ª–∏–ø–∞—Ç—å\n\n"
            "**–£—Ç–æ—á–Ω–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ü–∏—Ñ—Ä:**\n"
            "‚Ä¢ –ß–µ—Ä–Ω–æ–≤–∞—è ‚Äî –±–æ–ª—å—à–µ —Å—ä—ë–º, –º–µ–Ω—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å\n"
            "‚Ä¢ –ß–∏—Å—Ç–æ–≤–∞—è ‚Äî –±–ª–µ—Å–∫ –∏ —Ç–æ—á–Ω–æ—Å—Ç—å"
        )

    # ==================== –°–¢–ê–õ–¨ ====================
    @staticmethod
    def _steel_turning_rough():
        return (
            "‚öôÔ∏è **–î–ª—è —á–µ—Ä–Ω–æ–≤–æ–π —Ç–æ–∫–∞—Ä–∫–∏ —Å—Ç–∞–ª–∏:**\n\n"
            "**–°—Ç–∞—Ä—Ç–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**\n"
            "‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: 100-160 –º–µ—Ç—Ä–æ–≤ –≤ –º–∏–Ω—É—Ç—É\n"
            "‚Ä¢ –ü–æ–¥–∞—á–∞: 0.2-0.35 –º–º/–æ–±\n"
            "‚Ä¢ –ì–ª—É–±–∏–Ω–∞: 2-3 –º–º ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ\n\n"
            "**–ù–∞ —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:**\n"
            "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π –°–û–ñ ‚Äî —Å—Ç–∞–ª—å –≥—Ä–µ–µ—Ç—Å—è\n"
            "‚Ä¢ –°—Ç—Ä—É–∂–∫–∞ –¥–æ–ª–∂–Ω–∞ –ª–æ–º–∞—Ç—å—Å—è\n"
            "‚Ä¢ –ï—Å–ª–∏ —Å—Ç–∞–Ω–æ–∫ '–ø–æ—ë—Ç' ‚Äî —Å–Ω–∏–∑—å –ø–æ–¥–∞—á—É\n"
            "‚Ä¢ –î–ª—è —Å—Ç–∞–ª–∏ 45 ‚Äî –ø–ª–∞—Å—Ç–∏–Ω—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º"
        )

    @staticmethod
    def _steel_turning_finish():
        return (
            "üéØ **–î–ª—è —á–∏—Å—Ç–æ–≤–æ–π —Ç–æ–∫–∞—Ä–∫–∏ —Å—Ç–∞–ª–∏:**\n\n"
            "**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏:**\n"
            "‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: –ø–æ–≤—ã—à–µ, 160-220 –º/–º–∏–Ω\n"
            "‚Ä¢ –ü–æ–¥–∞—á–∞: 0.05-0.15 –º–º/–æ–± –¥–ª—è —Ö–æ—Ä–æ—à–µ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏\n"
            "‚Ä¢ –ì–ª—É–±–∏–Ω–∞: 0.2-0.5 –º–º –Ω–∞ —Ñ–∏–Ω–∏—à\n\n"
            "**–°–æ–≤–µ—Ç—ã:**\n"
            "‚Ä¢ –û—Å—Ç—Ä—ã–µ –ø–ª–∞—Å—Ç–∏–Ω—ã —Å –º–∞–ª–µ–Ω—å–∫–∏–º —Ä–∞–¥–∏—É—Å–æ–º\n"
            "‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ\n"
            "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–π —Ä–∞–∑–º–µ—Ä—ã –ø–æ—Å–ª–µ –æ—Å—Ç—ã–≤–∞–Ω–∏—è"
        )

    @staticmethod
    def _steel_turning_general():
        return (
            "üî© **–ü–æ —Å—Ç–∞–ª–∏ –¥–ª—è —Ç–æ–∫–∞—Ä–∫–∏:**\n\n"
            "**–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å:**\n"
            "‚Ä¢ –°—Ç–∞–ª—å —Ç—Ä–µ–±—É–µ—Ç –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è\n"
            "‚Ä¢ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—á–Ω–µ–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞\n"
            "‚Ä¢ –ù–∞–±–ª—é–¥–∞–π –∑–∞ —Ü–≤–µ—Ç–æ–º —Å—Ç—Ä—É–∂–∫–∏\n\n"
            "**–°–ø—Ä–æ—Å–∏ —É –º–µ–Ω—è –ø—Ä–æ:**\n"
            "‚Ä¢ –ß–µ—Ä–Ω–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É ‚Äî –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—ä—ë–º–∞\n"
            "‚Ä¢ –ß–∏—Å—Ç–æ–≤—É—é ‚Äî –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞"
        )

    # ==================== –û–ë–©–ï–ï ====================
    @staticmethod
    def _general_advice(material, operation):
        return (
            f"ü§î **–ü–æ {material} –¥–ª—è {operation}:**\n\n"
            "**–û–±—â–∏–π –ø–æ–¥—Ö–æ–¥:**\n"
            "1. –ù–∞—á–Ω–∏ —Å–æ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π\n"
            "2. –°–¥–µ–ª–∞–π –ø—Ä–æ–±–Ω—ã–π –ø—Ä–æ—Ö–æ–¥\n"
            "3. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å—Ç—Ä—É–∂–∫—É\n"
            "4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –ø–æ –æ—â—É—â–µ–Ω–∏—è–º\n\n"
            "**–ü—Ä–∞–≤–∏–ª–∞ —Ö–æ—Ä–æ—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:**\n"
            "‚Ä¢ –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∂–∫–∞ ‚Äî —Ö–æ—Ä–æ—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞\n"
            "‚Ä¢ –°—Ç–∞–Ω–æ–∫ –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–∏–ª—å–Ω–æ –≤–∏–±—Ä–∏—Ä–æ–≤–∞—Ç—å\n"
            "‚Ä¢ –î–µ—Ç–∞–ª—å –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞—Ç—å—Å—è\n"
            "‚Ä¢ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–ª—É–∂–∏—Ç—å –¥–æ–ª–≥–æ"
        )

    @staticmethod
    def format_response(context, recommendation):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç."""
        response = []

        response.append("ü§ñ **–í–æ—Ç —á—Ç–æ —è –¥—É–º–∞—é:**")
        response.append("")

        # –ö—Ä–∞—Ç–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
        response.append("üìå **–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**")
        if context.material:
            response.append(f"‚ñ∏ –ú–∞—Ç–µ—Ä–∏–∞–ª: {context.material}")
        if context.operation:
            response.append(f"‚ñ∏ –û–ø–µ—Ä–∞—Ü–∏—è: {context.operation}")
        if context.mode:
            response.append(f"‚ñ∏ –†–µ–∂–∏–º: {context.mode}")
        if context.tool:
            response.append(f"‚ñ∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: {context.tool}")
        response.append("")

        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
        response.append(recommendation)
        response.append("")

        # –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
        response.append("üí¨ **–ß—Ç–æ –¥–∞–ª—å—à–µ?**")
        response.append("‚Ä¢ –ù–∞–ø–∏—à–∏, –∫–∞–∫ –ø—Ä–æ—à–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞")
        response.append("‚Ä¢ –°–∫–∞–∂–∏, –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–æ—à–ª–æ")
        response.append("‚Ä¢ –ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å—ã")
        response.append("‚Ä¢ –ò–ª–∏ –Ω–∞—á–Ω–∏ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É")

        return "\n".join(response)
